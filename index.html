<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>NGC #1105 â€” Transfer Surge</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,400&family=Barlow:wght@300;400;500&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root {
  --c: #00e5ff;       /* cyan accent */
  --c2: #0097a7;      /* cyan dim */
  --g: #ffc107;       /* gold */
  --g2: #ff8f00;      /* gold dim */
  --p: #ce93d8;       /* purple */
  --r: #ff1744;       /* red alert */
  --bg: #04080f;
  --bg1: #070d18;
  --bg2: #0a1221;
  --bg3: #0e1a2e;
  --line: rgba(0,229,255,.12);
  --line2: rgba(0,229,255,.06);
  --text: #c8dce8;
  --text2: #6b8fa8;
  --text3: #3a5570;
  --font: 'Barlow', sans-serif;
  --cond: 'Barlow Condensed', sans-serif;
  --mono: 'Share Tech Mono', monospace;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;-webkit-tap-highlight-color:transparent;}
body{
  background:var(--bg);
  color:var(--text);
  font-family:var(--font);
  min-height:100vh;
  overflow-x:hidden;
  -webkit-font-smoothing:antialiased;
}

/* â”€â”€ GRID BACKGROUND â”€â”€ */
body::before{
  content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background-image:
    linear-gradient(var(--line2) 1px,transparent 1px),
    linear-gradient(90deg,var(--line2) 1px,transparent 1px);
  background-size:40px 40px;
  mask-image:radial-gradient(ellipse 100% 80% at 50% 0%,#000 40%,transparent 100%);
}
body::after{
  content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background:
    radial-gradient(ellipse 70% 40% at 15% 20%,rgba(0,229,255,.07) 0%,transparent 70%),
    radial-gradient(ellipse 50% 50% at 85% 70%,rgba(206,147,216,.06) 0%,transparent 70%),
    radial-gradient(ellipse 40% 30% at 50% 100%,rgba(255,193,7,.05) 0%,transparent 70%);
}

/* â”€â”€ SCANLINE OVERLAY â”€â”€ */
.scanlines{
  position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.025;
  background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.5) 2px,rgba(0,0,0,.5) 4px);
}

/* â”€â”€ WRAP â”€â”€ */
.wrap{
  position:relative;z-index:1;
  max-width:480px;margin:0 auto;
  padding:0 14px max(env(safe-area-inset-bottom),32px);
}

/* â”€â”€ TOP BAR â”€â”€ */
.topbar{
  display:flex;align-items:center;justify-content:space-between;
  padding:max(env(safe-area-inset-top),16px) 0 16px;
  border-bottom:1px solid var(--line);
  margin-bottom:0;
}
.topbar-brand{
  font-family:var(--cond);font-size:11px;font-weight:700;
  letter-spacing:4px;text-transform:uppercase;color:var(--c2);
  display:flex;align-items:center;gap:8px;
}
.topbar-brand::before{
  content:'';width:6px;height:6px;background:var(--c);
  box-shadow:0 0 8px var(--c);animation:blink 2s ease-in-out infinite;
}
@keyframes blink{0%,100%{opacity:1;}50%{opacity:.2;}}
.lang-bar{display:flex;gap:4px;}
.lang-btn{
  width:36px;height:36px;background:transparent;
  border:1px solid var(--line);
  font-size:17px;cursor:pointer;transition:all .2s;
  display:flex;align-items:center;justify-content:center;
  clip-path:polygon(0 0,calc(100% - 6px) 0,100% 6px,100% 100%,6px 100%,0 calc(100% - 6px));
}
.lang-btn:hover{border-color:var(--c);background:rgba(0,229,255,.06);}
.lang-btn.active{border-color:var(--g);background:rgba(255,193,7,.08);box-shadow:0 0 12px rgba(255,193,7,.2);}

/* â”€â”€ HERO â”€â”€ */
.hero{
  padding:40px 0 36px;
  border-bottom:1px solid var(--line);
}
.hero-tag{
  font-family:var(--mono);font-size:10px;color:var(--c);
  letter-spacing:3px;text-transform:uppercase;margin-bottom:16px;
  display:flex;align-items:center;gap:8px;
}
.hero-tag::before{content:'â–¶';font-size:7px;}
.hero-title{
  font-family:var(--cond);font-size:clamp(48px,12vw,72px);
  font-weight:900;line-height:.95;letter-spacing:-1px;
  text-transform:uppercase;color:#fff;margin-bottom:6px;
}
.hero-title .gold{color:var(--g);display:block;}
.hero-title .dim{font-weight:300;color:var(--text2);}
.hero-sub{
  font-size:14px;color:var(--text2);line-height:1.6;
  margin-top:14px;font-weight:300;
  border-left:2px solid var(--line);padding-left:12px;
}

/* â”€â”€ SECTION HEADER â”€â”€ */
.sec{
  display:flex;align-items:center;gap:12px;
  padding:24px 0 12px;
}
.sec-num{
  font-family:var(--mono);font-size:9px;color:var(--c2);
  border:1px solid var(--line);padding:2px 6px;flex-shrink:0;
}
.sec-title{
  font-family:var(--cond);font-size:13px;font-weight:700;
  letter-spacing:4px;text-transform:uppercase;color:var(--text);
}
.sec::after{content:'';flex:1;height:1px;background:var(--line);}

/* â”€â”€ PANEL â”€â”€ */
.panel{
  background:var(--bg1);
  border:1px solid var(--line);
  padding:18px 16px;
  margin-bottom:10px;
  position:relative;overflow:hidden;
}
.panel::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,var(--c2),transparent);
  opacity:.5;
}
.panel-gold::before{background:linear-gradient(90deg,transparent,var(--g2),transparent);}
.panel-purple::before{background:linear-gradient(90deg,transparent,var(--p),transparent);opacity:.4;}
.corner{
  position:absolute;width:10px;height:10px;
  border-color:var(--c2);border-style:solid;opacity:.5;
}
.corner-tl{top:0;left:0;border-width:1px 0 0 1px;}
.corner-tr{top:0;right:0;border-width:1px 1px 0 0;}
.corner-bl{bottom:0;left:0;border-width:0 0 1px 1px;}
.corner-br{bottom:0;right:0;border-width:0 1px 1px 0;}

.panel-label{
  font-family:var(--mono);font-size:9px;color:var(--text3);
  letter-spacing:2px;text-transform:uppercase;margin-bottom:10px;
}
.panel-text{
  font-size:13px;color:var(--text2);line-height:1.7;font-weight:300;
}
.panel-text em{color:var(--g);font-style:normal;font-weight:500;}

/* â”€â”€ POWER INPUT â”€â”€ */
.power-row{display:flex;gap:8px;margin-top:14px;}
.power-field{flex:1;position:relative;}
.power-field input{
  width:100%;height:54px;background:var(--bg2);
  border:1px solid var(--line);border-top-color:var(--c2);
  color:#fff;font-family:var(--mono);font-size:22px;font-weight:700;
  padding:0 14px;outline:none;transition:all .25s;
  -webkit-appearance:none;
  clip-path:polygon(0 0,calc(100% - 8px) 0,100% 8px,100% 100%,0 100%);
}
.power-field input:focus{
  border-color:var(--c);background:rgba(0,229,255,.04);
  box-shadow:inset 0 0 20px rgba(0,229,255,.06),0 0 0 1px rgba(0,229,255,.2);
}
.power-field input::placeholder{color:var(--text3);font-size:13px;font-weight:400;}
.power-field input::-webkit-inner-spin-button{display:none;}
.btn-calc{
  height:54px;padding:0 20px;background:var(--g);color:#000;
  font-family:var(--cond);font-size:14px;font-weight:900;
  letter-spacing:2px;text-transform:uppercase;border:none;cursor:pointer;
  transition:all .2s;flex-shrink:0;
  clip-path:polygon(8px 0,100% 0,100% calc(100% - 8px),calc(100% - 8px) 100%,0 100%,0 8px);
}
.btn-calc:hover{background:#ffd740;box-shadow:0 0 24px rgba(255,193,7,.4);}
.btn-calc:active{transform:scale(.97);}

/* â”€â”€ SEAT SCALE â”€â”€ */
.seat-scale{
  display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-top:16px;
}
.si{
  padding:10px 4px;border:1px solid var(--line);
  text-align:center;opacity:.25;transition:all .35s;position:relative;
}
.si.active{opacity:1;}
.si.active::after{
  content:'';position:absolute;bottom:0;left:0;right:0;height:2px;
}
.si.active.sw{border-color:rgba(148,163,184,.4);background:rgba(148,163,184,.05);}
.si.active.sw::after{background:rgba(148,163,184,.6);}
.si.active.sb{border-color:rgba(0,229,255,.4);background:rgba(0,229,255,.05);box-shadow:0 0 12px rgba(0,229,255,.1);}
.si.active.sb::after{background:var(--c);box-shadow:0 0 8px var(--c);}
.si.active.sp{border-color:rgba(206,147,216,.4);background:rgba(206,147,216,.05);box-shadow:0 0 12px rgba(206,147,216,.1);}
.si.active.sp::after{background:var(--p);}
.si.active.sg{border-color:rgba(255,193,7,.5);background:rgba(255,193,7,.06);box-shadow:0 0 16px rgba(255,193,7,.2);animation:sglow 2s ease-in-out infinite;}
.si.active.sg::after{background:var(--g);box-shadow:0 0 8px var(--g);}
@keyframes sglow{0%,100%{box-shadow:0 0 10px rgba(255,193,7,.15);}50%{box-shadow:0 0 24px rgba(255,193,7,.4);}}
.si-ico{font-size:18px;display:block;margin-bottom:4px;}
.si-name{font-family:var(--cond);font-size:9px;font-weight:700;letter-spacing:1px;text-transform:uppercase;}
.si-name.sw{color:#94a3b8;} .si-name.sb{color:var(--c);} .si-name.sp{color:var(--p);} .si-name.sg{color:var(--g);}
.si-range{font-family:var(--mono);font-size:8px;color:var(--text3);margin-top:2px;}

/* â”€â”€ SEAT RESULT â”€â”€ */
.seat-result{display:none;margin-top:12px;animation:fadeIn .4s ease;}
.seat-result.visible{display:block;}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}

.seat-display{
  display:flex;align-items:center;gap:14px;
  padding:16px;border:1px solid;position:relative;overflow:hidden;
}
.seat-display::after{
  content:'CONFIRMED';position:absolute;
  right:-8px;top:50%;transform:translateY(-50%) rotate(90deg);
  font-family:var(--mono);font-size:7px;letter-spacing:3px;opacity:.2;
}
.seat-display.sw{border-color:rgba(148,163,184,.3);background:rgba(148,163,184,.04);}
.seat-display.sb{border-color:rgba(0,229,255,.35);background:rgba(0,229,255,.04);}
.seat-display.sp{border-color:rgba(206,147,216,.35);background:rgba(206,147,216,.04);}
.seat-display.sg{border-color:rgba(255,193,7,.4);background:rgba(255,193,7,.04);}
.seat-ico{font-size:40px;line-height:1;flex-shrink:0;}
.seat-nm{
  font-family:var(--cond);font-size:26px;font-weight:900;
  letter-spacing:2px;text-transform:uppercase;line-height:1;
}
.seat-nm.sw{color:#94a3b8;} .seat-nm.sb{color:var(--c);text-shadow:0 0 16px rgba(0,229,255,.4);}
.seat-nm.sp{color:var(--p);} .seat-nm.sg{color:var(--g);text-shadow:0 0 20px rgba(255,193,7,.4);}
.seat-ds{font-size:12px;color:var(--text2);margin-top:5px;line-height:1.5;font-weight:300;}
.seat-warn{
  display:flex;gap:8px;margin-top:10px;padding:10px 12px;
  background:rgba(255,193,7,.04);border:1px solid rgba(255,193,7,.15);
  border-left:2px solid rgba(255,193,7,.4);
  font-family:var(--mono);font-size:10px;color:var(--text2);line-height:1.7;
}

/* â”€â”€ ALLIANCES â”€â”€ */
.allo{margin-bottom:6px;}
.allo input[type="radio"]{display:none;}
.allo-label{
  display:flex;gap:12px;align-items:flex-start;
  padding:14px;border:1px solid var(--line);
  background:var(--bg1);cursor:pointer;transition:all .2s;
  position:relative;overflow:hidden;
}
.allo-label::before{
  content:'';position:absolute;top:0;left:0;width:2px;height:100%;
  background:var(--line);transition:background .2s;
}
.allo-label:hover{border-color:rgba(0,229,255,.2);background:rgba(0,229,255,.02);}
.allo-label:hover::before{background:rgba(0,229,255,.4);}
.allo input:checked+.allo-label{
  border-color:rgba(206,147,216,.4);
  background:rgba(206,147,216,.05);
}
.allo input:checked+.allo-label::before{background:var(--p);}
.allo input:checked+.allo-label .allo-dot{
  background:var(--p);box-shadow:0 0 8px var(--p);border-color:var(--p);
}
.allo-dot{
  width:14px;height:14px;border:1px solid var(--line2);
  flex-shrink:0;margin-top:3px;transition:all .2s;
  clip-path:polygon(50% 0%,100% 50%,50% 100%,0% 50%);
  background:transparent;
}
.allo-body{flex:1;min-width:0;}
.allo-head{display:flex;align-items:baseline;justify-content:space-between;margin-bottom:6px;gap:6px;flex-wrap:wrap;}
.allo-tag{font-family:var(--cond);font-size:16px;font-weight:800;color:var(--g);letter-spacing:1px;}
.allo-name{font-size:12px;color:var(--text2);font-weight:300;}
.allo-rank{font-family:var(--mono);font-size:9px;color:var(--text3);margin-left:auto;flex-shrink:0;}
.allo-req{font-size:12px;color:var(--text);font-weight:500;line-height:1.5;margin-bottom:4px;}
.allo-desc{font-size:11px;color:var(--text2);line-height:1.6;font-weight:300;}

/* â”€â”€ FORM â”€â”€ */
.field{display:flex;flex-direction:column;gap:7px;margin-bottom:12px;}
.field-lbl{
  font-family:var(--mono);font-size:9px;letter-spacing:3px;
  color:var(--text3);text-transform:uppercase;
  display:flex;align-items:center;gap:6px;
}
.field-lbl::before{content:'//';color:var(--c2);opacity:.6;}
.req{color:var(--c);margin-left:2px;}
.field-in,.field-sel,.field-ta{
  width:100%;background:var(--bg2);
  border:1px solid var(--line);border-bottom-color:rgba(0,229,255,.2);
  color:var(--text);font-family:var(--font);font-size:15px;
  padding:13px 14px;outline:none;transition:all .2s;
  -webkit-appearance:none;
  border-radius:0;
}
.field-in:focus,.field-sel:focus,.field-ta:focus{
  border-color:var(--c);background:rgba(0,229,255,.03);
  box-shadow:0 4px 20px rgba(0,229,255,.06);
}
.field-in::placeholder,.field-ta::placeholder{color:var(--text3);font-size:13px;}
.field-in::-webkit-inner-spin-button{display:none;}
.field-sel{
  cursor:pointer;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='7'%3E%3Cpath fill='%233a5570' d='M5 7L0 0h10z'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:right 14px center;padding-right:36px;
}
.field-sel option{background:#0e1a2e;}
.field-ta{resize:vertical;min-height:88px;line-height:1.6;}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
@media(max-width:360px){.form-row{grid-template-columns:1fr;}}

/* â”€â”€ SUBMIT â”€â”€ */
.btn-submit{
  width:100%;padding:18px;margin-top:8px;
  background:transparent;
  border:1px solid rgba(0,229,255,.4);
  color:var(--c);font-family:var(--cond);font-size:16px;font-weight:800;
  letter-spacing:4px;text-transform:uppercase;cursor:pointer;
  transition:all .25s;position:relative;overflow:hidden;
}
.btn-submit::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(90deg,transparent,rgba(0,229,255,.08),transparent);
  transform:translateX(-100%);transition:transform .4s;
}
.btn-submit:hover{
  background:rgba(0,229,255,.06);
  border-color:var(--c);box-shadow:0 0 30px rgba(0,229,255,.15),inset 0 0 30px rgba(0,229,255,.04);
}
.btn-submit:hover::before{transform:translateX(100%);}
.btn-submit:active{transform:scale(.99);}

/* â”€â”€ SUCCESS â”€â”€ */
.success-msg{display:none;text-align:center;padding:60px 20px;animation:fadeIn .5s ease;}
.success-msg.visible{display:block;}
.ok-icon{font-size:52px;margin-bottom:20px;}
.ok-title{
  font-family:var(--cond);font-size:28px;font-weight:900;
  letter-spacing:3px;text-transform:uppercase;
  color:var(--c);text-shadow:0 0 20px rgba(0,229,255,.4);
  margin-bottom:12px;
}
.ok-sub{font-size:14px;color:var(--text2);line-height:1.7;font-weight:300;}

/* â”€â”€ FOOTER â”€â”€ */
footer{
  padding:24px 0 8px;text-align:center;
  font-family:var(--mono);font-size:9px;color:var(--text3);letter-spacing:3px;
  border-top:1px solid var(--line);margin-top:16px;
}

/* â”€â”€ STAGGER ENTRY ANIMATIONS â”€â”€ */
.hero,.sec,.panel,.allo{animation:entryFade .5s ease both;}
.hero{animation-delay:.05s;}
@keyframes entryFade{from{opacity:0;transform:translateY(12px);}to{opacity:1;transform:translateY(0);}}
</style>
</head>
<body>
<div class="scanlines"></div>
<div class="wrap">

  <!-- TOP BAR -->
  <div class="topbar">
    <div class="topbar-brand">SERVER #1105 Â· TRANSFER SURGE</div>
    <div class="lang-bar">
      <button class="lang-btn active" onclick="setLang('it')">ðŸ‡®ðŸ‡¹</button>
      <button class="lang-btn" onclick="setLang('fr')">ðŸ‡«ðŸ‡·</button>
      <button class="lang-btn" onclick="setLang('en')">ðŸ‡¬ðŸ‡§</button>
      <button class="lang-btn" onclick="setLang('de')">ðŸ‡©ðŸ‡ª</button>
    </div>
  </div>

  <!-- HERO -->
  <div class="hero">
    <div class="hero-tag" id="hBadge"></div>
    <div class="hero-title">
      <span class="gold" id="hAlliance">SERVER #1105</span>
      <span id="hTitle"></span>
    </div>
    <p class="hero-sub" id="hDesc"></p>
  </div>

  <!-- SIMULATOR -->
  <div class="sec">
    <span class="sec-num">01</span>
    <span class="sec-title" id="simTitle"></span>
  </div>
  <div class="panel panel-gold">
    <div class="corner corner-tl"></div><div class="corner corner-tr"></div>
    <div class="corner corner-bl"></div><div class="corner corner-br"></div>
    <div class="panel-text" id="simIntro"></div>
    <div class="power-row">
      <div class="power-field">
        <input type="number" id="powerInput" min="0">
      </div>
      <button class="btn-calc" id="simBtn" onclick="calcSeat()"></button>
    </div>
    <div class="seat-scale">
      <div class="si sw"><span class="si-ico">ðŸª‘</span><div class="si-name sw">FOLLOW.</div><div class="si-range">&lt;100M</div></div>
      <div class="si sb"><span class="si-ico">ðŸ”µ</span><div class="si-name sb">PIONEER</div><div class="si-range">100â€“150M</div></div>
      <div class="si sp"><span class="si-ico">ðŸŸ£</span><div class="si-name sp">CONTRIB.</div><div class="si-range">150â€“210M</div></div>
      <div class="si sg"><span class="si-ico">ðŸ‘‘</span><div class="si-name sg">ELITE</div><div class="si-range">&gt;210M</div></div>
    </div>
    <div class="seat-result" id="seatResult">
      <div class="seat-display" id="seatDisplay">
        <div class="seat-ico" id="seatIcon"></div>
        <div>
          <div class="seat-nm" id="seatName"></div>
          <div class="seat-ds" id="seatDesc"></div>
        </div>
      </div>
      <div class="seat-warn" id="simWarning"></div>
    </div>
  </div>

  <!-- ALLIANCES -->
  <div class="sec">
    <span class="sec-num">02</span>
    <span class="sec-title" id="allTitle"></span>
  </div>
  <div class="panel-text" style="font-size:13px;margin-bottom:14px;padding-left:2px;" id="allIntro"></div>
  <div id="allianceGrid"></div>

  <!-- FORM -->
  <div id="formSection">
    <div class="sec">
      <span class="sec-num">03</span>
      <span class="sec-title" id="formTitle"></span>
    </div>
    <div class="panel">
      <div class="corner corner-tl"></div><div class="corner corner-tr"></div>
      <div class="corner corner-bl"></div><div class="corner corner-br"></div>

      <div class="form-row">
        <div class="field">
          <div class="field-lbl" id="lNick"></div>
          <input class="field-in" type="text" id="fNick">
        </div>
        <div class="field">
          <div class="field-lbl" id="lPower"></div>
          <input class="field-in" type="number" id="fPower" min="0">
        </div>
      </div>
      <div class="form-row">
        <div class="field">
          <div class="field-lbl" id="lServer"></div>
          <input class="field-in" type="text" id="fServer">
        </div>
        <div class="field">
          <div class="field-lbl" id="lIntent"></div>
          <select class="field-sel" id="fIntent">
            <option value="" id="iOpt0"></option>
            <option value="yes_sure" id="iOpt1"></option>
            <option value="interested" id="iOpt2"></option>
            <option value="maybe" id="iOpt3"></option>
            <option value="no" id="iOpt4"></option>
          </select>
        </div>
      </div>
      <div class="field">
        <div class="field-lbl" id="lAlliance"></div>
        <select class="field-sel" id="fAlliance"><option value="" id="fAlliancePh"></option></select>
      </div>
      <div class="field">
        <div class="field-lbl" id="lBio"></div>
        <textarea class="field-ta" id="fBio"></textarea>
      </div>
      <button class="btn-submit" id="btnSubmit" onclick="submitForm()"></button>
    </div>
  </div>

  <!-- SUCCESS -->
  <div class="success-msg" id="successMsg">
    <div class="ok-icon">âš¡</div>
    <div class="ok-title" id="okTitle"></div>
    <div class="ok-sub" id="okSub"></div>
  </div>

  <footer>NGC Â© 2026 Â· SERVER #1105 Â· TRANSFER SURGE Â· ORG. BY [NgC] NIGHT COMMANDO</footer>
</div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwO03mROK8NNru3R-6w4y8vmA48_bAWYSflnseYLm__ThQkO0s7G0Uel9asZKlTROWN/exec';

const T = {
  it:{
    badge:'â—† ORGANIZZATO DA [NgC] NIGHT COMMANDO',
    h1:'TRANSFER<br>SURGE',
    hdesc:'Candidatura aperta a tutti i player del server. Trova la tua sedia e scegli la tua alleanza.',
    simTitle:'SIMULATORE SEDIA',
    simIntro:'Inserisci la tua <em>potenza totale eroi</em> per stimare il colore della tua sedia. Valore approssimativo â€” le soglie cambiano ad ogni Transfer Surge.',
    simPh:'es. 130000000',simBtn:'CALCOLA',
    simWarn:'âš  Stima basata su soglie medie. Il colore reale dipenderÃ  dalla forza del tuo gruppo di server al momento dell\'evento.',
    seatDesc:{white:'Giocatore in crescita. Posti disponibili in buona quantitÃ .',blue:'Giocatore consolidato. Risorsa preziosa per qualsiasi alleanza.',purple:'Giocatore avanzato. Posti limitati â€” i server forti ti cercano.',gold:'Top player. Posti rarissimi. Il tuo arrivo cambia le sorti di un server.'},
    allTitle:'LE NOSTRE ALLEANZE',
    allIntro:'Il Transfer Surge #1105 coinvolge tutte le alleanze del server. Esplora i profili e candidati a quella che fa per te.',
    formTitle:'LA TUA CANDIDATURA',
    lNick:'Nickname *',nickPh:'Il tuo nome in gioco',
    lPower:'Potenza *',
    lServer:'Server *',serverPh:'es. #1082',
    lIntent:'Vuoi venire su #1105?',
    iOpts:['â€” Seleziona â€”','SÃ¬, assolutamente!','Mi interessa, piÃ¹ info','Forse, sto valutando','No, solo per info'],
    lAlliance:'Alleanza preferita *',alliancePh:'â€” Scegli un\'alleanza â€”',
    lBio:'Presentati (opzionale)',bioPh:'Stile di gioco, esperienza, lingua...',
    btnSubmit:'INVIA CANDIDATURA',
    okTitle:'CANDIDATURA RICEVUTA',
    okSub:'Il tuo profilo Ã¨ stato registrato. Un leader ti contatterÃ  durante la fase di preparazione del Transfer Surge.',
    errFields:'âš  Compila tutti i campi obbligatori (*)',
    errPower:'âš  Inserisci una potenza valida!',
    allyTextMissing:'Testi in aggiornamento...'
  },
  fr:{
    badge:'â—† ORGANISÃ‰ PAR [NgC] NIGHT COMMANDO',
    h1:'TRANSFER<br>SURGE',
    hdesc:'Candidature ouverte Ã  tous les joueurs du serveur. Trouve ton siÃ¨ge et choisis ton alliance.',
    simTitle:'SIMULATEUR DE SIÃˆGE',
    simIntro:'Saisis ta <em>puissance totale des hÃ©ros</em> pour estimer la couleur de ton siÃ¨ge. Valeur approximative â€” les seuils varient Ã  chaque Transfer Surge.',
    simPh:'ex. 130000000',simBtn:'CALCULER',
    simWarn:'âš  Estimation basÃ©e sur des seuils moyens. La couleur rÃ©elle dÃ©pendra de la force de ton groupe au moment de l\'Ã©vÃ©nement.',
    seatDesc:{white:'Joueur en progression. Places disponibles en bonne quantitÃ©.',blue:'Joueur confirmÃ©. Une ressource prÃ©cieuse pour toute alliance.',purple:'Joueur avancÃ©. Places limitÃ©es â€” les serveurs forts te recherchent.',gold:'Top joueur. Places rarissimes. Ton arrivÃ©e change le destin d\'un serveur.'},
    allTitle:'NOS ALLIANCES',
    allIntro:'Le Transfer Surge #1105 implique toutes les alliances du serveur. Explore les profils et postule Ã  celle qui te correspond.',
    formTitle:'TA CANDIDATURE',
    lNick:'Pseudo *',nickPh:'Ton pseudo dans le jeu',lPower:'Puissance *',lServer:'Serveur *',serverPh:'ex. #1082',
    lIntent:'Veux-tu venir sur #1105 ?',
    iOpts:['â€” SÃ©lectionner â€”','Oui, absolument !','Ã‡a m\'intÃ©resse, plus d\'infos','Peut-Ãªtre, j\'Ã©value encore','Non, juste pour info'],
    lAlliance:'Alliance prÃ©fÃ©rÃ©e *',alliancePh:'â€” Choisir une alliance â€”',
    lBio:'PrÃ©sente-toi (optionnel)',bioPh:'Style de jeu, expÃ©rience, langue...',
    btnSubmit:'ENVOYER MA CANDIDATURE',
    okTitle:'CANDIDATURE REÃ‡UE',
    okSub:'Ton profil a Ã©tÃ© enregistrÃ©. Un leader te contactera pendant la phase de prÃ©paration du Transfer Surge.',
    errFields:'âš  Remplis tous les champs obligatoires (*)',errPower:'âš  Saisis une puissance valide !',
    allyTextMissing:'Textes en cours de mise Ã  jour...'
  },
  en:{
    badge:'â—† ORGANIZED BY [NgC] NIGHT COMMANDO',
    h1:'TRANSFER<br>SURGE',
    hdesc:'Open to all players on the server. Find your seat and choose your alliance.',
    simTitle:'SEAT SIMULATOR',
    simIntro:'Enter your <em>total hero power</em> to estimate your seat color. Approximate value â€” thresholds change with every Transfer Surge.',
    simPh:'e.g. 130000000',simBtn:'CALCULATE',
    simWarn:'âš  Estimate based on average thresholds. Your real color depends on your server group\'s strength at event time.',
    seatDesc:{white:'Growing player. Seats available in good quantity.',blue:'Established player. A valuable asset for any alliance.',purple:'Advanced player. Limited seats â€” strong servers want you.',gold:'Top player. Extremely rare seats. Your arrival changes a server\'s fate.'},
    allTitle:'OUR ALLIANCES',
    allIntro:'Transfer Surge #1105 involves all alliances on the server. Explore their profiles and apply to the one that suits you.',
    formTitle:'YOUR APPLICATION',
    lNick:'Nickname *',nickPh:'Your in-game name',lPower:'Power *',lServer:'Server *',serverPh:'e.g. #1082',
    lIntent:'Do you want to join #1105?',
    iOpts:['â€” Select â€”','Yes, absolutely!','Interested, want more info','Maybe, still considering','No, just for info'],
    lAlliance:'Preferred Alliance *',alliancePh:'â€” Choose an alliance â€”',
    lBio:'About you (optional)',bioPh:'Playstyle, experience, language...',
    btnSubmit:'SUBMIT APPLICATION',
    okTitle:'APPLICATION RECEIVED',
    okSub:'Your profile has been recorded. A leader will contact you during the Transfer Surge preparation phase.',
    errFields:'âš  Please fill in all required fields (*)',errPower:'âš  Enter a valid power value!',
    allyTextMissing:'Texts being updated...'
  },
  de:{
    badge:'â—† ORGANISIERT VON [NgC] NIGHT COMMANDO',
    h1:'TRANSFER<br>SURGE',
    hdesc:'Offen fÃ¼r alle Spieler des Servers. Finde deinen Sitz und wÃ¤hle deine Allianz.',
    simTitle:'SITZ-SIMULATOR',
    simIntro:'Gib deine <em>gesamte HeldenstÃ¤rke</em> ein, um deine Sitzfarbe abzuschÃ¤tzen. UngefÃ¤hrer Wert â€” Schwellenwerte variieren bei jedem Transfer Surge.',
    simPh:'z.B. 130000000',simBtn:'BERECHNEN',
    simWarn:'âš  SchÃ¤tzung auf Basis durchschnittlicher Schwellenwerte. Die echte Farbe hÃ¤ngt von der StÃ¤rke deiner Servergruppe ab.',
    seatDesc:{white:'Wachsender Spieler. Viele PlÃ¤tze verfÃ¼gbar.',blue:'Erfahrener Spieler. Wertvolle Ressource fÃ¼r jede Allianz.',purple:'Fortgeschrittener Spieler. Begrenzte PlÃ¤tze â€” starke Server suchen dich.',gold:'Top-Spieler. Ã„uÃŸerst seltene PlÃ¤tze. Deine Ankunft verÃ¤ndert ein Server-Schicksal.'},
    allTitle:'UNSERE ALLIANZEN',
    allIntro:'Der Transfer Surge #1105 umfasst alle Allianzen des Servers. Erkunde die Profile und bewirb dich bei der passenden.',
    formTitle:'DEINE BEWERBUNG',
    lNick:'Nickname *',nickPh:'Dein Spielername',lPower:'StÃ¤rke *',lServer:'Server *',serverPh:'z.B. #1082',
    lIntent:'MÃ¶chtest du zu #1105?',
    iOpts:['â€” AuswÃ¤hlen â€”','Ja, auf jeden Fall!','Interessiert, mehr Infos','Vielleicht, ich Ã¼berlege noch','Nein, nur zur Info'],
    lAlliance:'Bevorzugte Allianz *',alliancePh:'â€” Allianz wÃ¤hlen â€”',
    lBio:'Stell dich vor (optional)',bioPh:'Spielstil, Erfahrung, Sprache...',
    btnSubmit:'BEWERBUNG ABSENDEN',
    okTitle:'BEWERBUNG ERHALTEN',
    okSub:'Dein Profil wurde gespeichert. Ein Leader wird dich wÃ¤hrend der Vorbereitungsphase des Transfer Surge kontaktieren.',
    errFields:'âš  Bitte fÃ¼lle alle Pflichtfelder (*) aus',errPower:'âš  Bitte gib eine gÃ¼ltige StÃ¤rke ein!',
    allyTextMissing:'Texte werden aktualisiert...'
  }
};

const ALLIANCES = [
  {tag:'NgC', name:'Night Commando',      rank:'#1 Â· 20.4B'},
  {tag:'DJN', name:'THE RISE',            rank:'#2 Â· 17.9B'},
  {tag:'VNEM',name:'True Unity',          rank:'#3 Â· 17.3B'},
  {tag:'LdKy',name:'GottisUnitedKnights', rank:'#4 Â· 15.6B'},
  {tag:'FmLy',name:'Family01',            rank:'#5 Â· 14.1B'},
  {tag:'BwF', name:'Better with Family',  rank:'#6 Â· 13.9B'},
  {tag:'CZNS',name:'CheZ NouS',           rank:'#8 Â· 12.3B'},
  {tag:'GLDY',name:'GLADÄ°ATORS',          rank:'#9 Â· 8.3B'},
];

const SEATS = [
  {cls:'sw',name:'FOLLOWER',   icon:'ðŸª‘',scaleIdx:0,dk:'white'},
  {cls:'sb',name:'PIONEER',    icon:'ðŸ”µ',scaleIdx:1,dk:'blue'},
  {cls:'sp',name:'CONTRIBUTOR',icon:'ðŸŸ£',scaleIdx:2,dk:'purple'},
  {cls:'sg',name:'ELITE âš¡',   icon:'ðŸ‘‘',scaleIdx:3,dk:'gold'},
];

let lang='it', lastSeatIdx=-1, remoteAllianceTexts={};

function setLang(l){
  lang=l; document.documentElement.lang=l;
  document.querySelectorAll('.lang-btn').forEach((b,i)=>b.classList.toggle('active',['it','fr','en','de'][i]===l));
  const t=T[l];
  document.getElementById('hBadge').textContent=t.badge;
  document.getElementById('hTitle').innerHTML=t.h1;
  document.getElementById('hDesc').textContent=t.hdesc;
  document.getElementById('simTitle').textContent=t.simTitle;
  document.getElementById('simIntro').innerHTML=t.simIntro;
  document.getElementById('powerInput').placeholder=t.simPh;
  document.getElementById('simBtn').textContent=t.simBtn;
  document.getElementById('simWarning').textContent=t.simWarn;
  document.getElementById('allTitle').textContent=t.allTitle;
  document.getElementById('allIntro').textContent=t.allIntro;
  buildAlliances();
  document.getElementById('formTitle').textContent=t.formTitle;
  document.getElementById('lNick').textContent=t.lNick;
  document.getElementById('fNick').placeholder=t.nickPh;
  document.getElementById('lPower').textContent=t.lPower;
  document.getElementById('lServer').textContent=t.lServer;
  document.getElementById('fServer').placeholder=t.serverPh;
  document.getElementById('lIntent').textContent=t.lIntent;
  document.getElementById('lAlliance').textContent=t.lAlliance;
  document.getElementById('fAlliancePh').textContent=t.alliancePh;
  document.getElementById('lBio').textContent=t.lBio;
  document.getElementById('fBio').placeholder=t.bioPh;
  document.getElementById('btnSubmit').textContent=t.btnSubmit;
  t.iOpts.forEach((txt,i)=>{const el=document.getElementById('iOpt'+i);if(el)el.textContent=txt;});
  document.getElementById('okTitle').textContent=t.okTitle;
  document.getElementById('okSub').textContent=t.okSub;
  if(lastSeatIdx>=0)renderSeat(lastSeatIdx,false);
}

function buildAlliances(){
  const t=T[lang],grid=document.getElementById('allianceGrid'),sel=document.getElementById('fAlliance'),prev=sel.value;
  grid.innerHTML=''; while(sel.options.length>1)sel.remove(1);
  ALLIANCES.forEach((a,i)=>{
    const remote=remoteAllianceTexts[a.tag]?.[lang]||{};
    const td={req:remote.req||t.allyTextMissing,desc:remote.desc||''};
    const wrap=document.createElement('div'); wrap.className='allo';
    wrap.innerHTML=`
      <input type="radio" name="alliance" id="al${i}" value="${a.tag}" ${prev===a.tag?'checked':''}>
      <label class="allo-label" for="al${i}">
        <div class="allo-dot"></div>
        <div class="allo-body">
          <div class="allo-head">
            <span class="allo-tag">[${a.tag}]</span>
            <span class="allo-name">${a.name}</span>
            <span class="allo-rank">${a.rank}</span>
          </div>
          <div class="allo-req">${td.req}</div>
          ${td.desc?`<div class="allo-desc">${td.desc}</div>`:''}
        </div>
      </label>`;
    wrap.querySelector('input').addEventListener('change',()=>{sel.value=a.tag;});
    grid.appendChild(wrap);
    const opt=document.createElement('option');opt.value=a.tag;opt.textContent=`[${a.tag}] ${a.name}`;sel.appendChild(opt);
  });
  sel.value=prev;
}

async function loadAllianceTexts(){
  try{
    const res=await fetch(SCRIPT_URL+'?action=getAll&t='+Date.now());
    const json=await res.json();
    if(json&&json.success&&json.allianceTexts){remoteAllianceTexts=json.allianceTexts;buildAlliances();}
  }catch(err){console.warn('loadAllianceTexts:',err);}
}

function getSeatIdx(p){
  if(p<100e6)return 0;
  if(p<150e6)return 1;
  if(p<210e6)return 2;
  return 3;
}

function renderSeat(idx,scroll){
  const s=SEATS[idx],t=T[lang];
  const disp=document.getElementById('seatDisplay');
  disp.className=`seat-display ${s.cls}`;
  document.getElementById('seatIcon').textContent=s.icon;
  const nm=document.getElementById('seatName');
  nm.className=`seat-nm ${s.cls}`; nm.textContent=s.name;
  document.getElementById('seatDesc').textContent=t.seatDesc[s.dk];
  document.querySelectorAll('.si').forEach((el,i)=>el.classList.toggle('active',i===s.scaleIdx));
  const res=document.getElementById('seatResult');
  res.classList.add('visible');
  if(scroll)res.scrollIntoView({behavior:'smooth',block:'nearest'});
}

function calcSeat(){
  const raw=document.getElementById('powerInput').value.replace(/[,.]/g,'');
  const val=parseFloat(raw);
  if(!val||val<=0){alert(T[lang].errPower);return;}
  document.getElementById('fPower').value=val;
  lastSeatIdx=getSeatIdx(val);
  renderSeat(lastSeatIdx,true);
}

document.getElementById('powerInput').addEventListener('keydown',e=>{if(e.key==='Enter')calcSeat();});

function submitForm(){
  const t=T[lang];
  const nick=document.getElementById('fNick').value.trim();
  const power=document.getElementById('fPower').value;
  const server=document.getElementById('fServer').value.trim();
  const alliance=document.getElementById('fAlliance').value;
  if(!nick||!server||!alliance){alert(t.errFields);return;}
  // Calcola sedia automaticamente se l'utente non ha usato il simulatore
  let seatName='';
  const rawPower=parseFloat(String(power).replace(/[,.]/g,''));
  if(rawPower>0){
    const autoIdx=getSeatIdx(rawPower);
    if(lastSeatIdx<0)lastSeatIdx=autoIdx;
    seatName=SEATS[lastSeatIdx].name;
  }
  const payload={lang,nickname:nick,power:power||'',server,alliance,
    intent:document.getElementById('fIntent').value,
    bio:document.getElementById('fBio').value.trim(),
    seat:seatName,ts:new Date().toISOString()};
  const btn=document.getElementById('btnSubmit');
  btn.textContent='...';btn.disabled=true;
  fetch(SCRIPT_URL,{method:'POST',headers:{'Content-Type':'text/plain;charset=utf-8'},body:JSON.stringify(payload)})
  .then(async r=>{const tx=await r.text();try{return JSON.parse(tx);}catch{throw new Error('Risposta non valida');}})
  .then(res=>{
    if(res.success){
      document.getElementById('formSection').style.display='none';
      const msg=document.getElementById('successMsg');msg.classList.add('visible');msg.scrollIntoView({behavior:'smooth'});
    }else{alert('Errore: '+(res.error||'sconosciuto'));btn.textContent=t.btnSubmit;btn.disabled=false;}
  })
  .catch(err=>{alert('Invio non riuscito: '+(err.message||'errore di rete'));btn.textContent=t.btnSubmit;btn.disabled=false;});
}

setLang('it');
loadAllianceTexts();
</script>
</body>
</html>
