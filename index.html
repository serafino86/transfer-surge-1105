<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NGC #1105 â€” Transfer Surge</title>
<script src="../config.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
  :root {
    --gold:#e3a72f; --gold-dim:#9f7721; --purple:#8c63cf; --blue:#1e9ec2;
    --white:#d5dee8; --bg:#f4f8fc; --surface:#ffffff; --surface2:#edf3f8;
    --border:#c8d7e6; --text:#1d3144; --dim:#567187;
  }
  *{box-sizing:border-box;margin:0;padding:0;}
  body{background:radial-gradient(circle at top,#ffffff 0%,#eff6fb 42%,#e5eff8 100%);color:var(--text);font-family:'Rajdhani',sans-serif;min-height:100vh;overflow-x:hidden;}
  body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(30,158,194,.08) 1px,transparent 1px),linear-gradient(90deg,rgba(30,158,194,.08) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0;}
  body::after{display:none;}

  .container{position:relative;z-index:1;max-width:860px;margin:0 auto;padding:20px 16px 60px;}

  /* LANG BAR */
  .lang-bar{display:flex;justify-content:flex-end;gap:6px;margin-bottom:20px;}
  .lang-btn{background:var(--surface);border:1px solid var(--border);color:var(--dim);font-family:'Share Tech Mono',monospace;font-size:20px;padding:5px 10px;cursor:pointer;transition:all .2s;line-height:1;}
  .lang-btn:hover{border-color:var(--blue);}
  .lang-btn.active{border-color:var(--gold);background:rgba(240,180,41,.08);}

  /* HEADER */
  header{text-align:center;padding:32px 0 28px;}
  .header-badge{display:inline-block;font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--blue);letter-spacing:3px;text-transform:uppercase;border:1px solid var(--border);background:rgba(255,255,255,.7);padding:4px 14px;margin-bottom:16px;}
  .header-badge::before,.header-badge::after{content:'â—†';margin:0 8px;color:var(--gold);font-size:8px;}
  h1{font-family:'Orbitron',monospace;font-size:clamp(26px,5.5vw,50px);font-weight:900;letter-spacing:2px;line-height:1.1;color:#153248;text-shadow:none;}
  h1 .sub{color:var(--gold);display:block;font-size:.52em;letter-spacing:6px;font-weight:400;margin-bottom:8px;}
  .header-desc{margin-top:12px;color:var(--dim);font-size:15px;letter-spacing:1px;}

  /* DIVIDER */
  .divider{display:flex;align-items:center;gap:12px;margin:24px 0;}
  .divider::before,.divider::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent);}
  .divider-icon{color:var(--gold);font-size:18px;}

  /* CARDS */
  .card{background:var(--surface);border:1px solid var(--border);padding:24px 18px;margin-bottom:20px;position:relative;clip-path:polygon(0 0,calc(100% - 18px) 0,100% 18px,100% 100%,18px 100%,0 calc(100% - 18px));box-shadow:0 8px 18px rgba(46,89,122,.08);}
  .card-gold::before,.card-blue::before,.card-purple::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;}
  .card-gold::before{background:linear-gradient(90deg,transparent,var(--gold),transparent);}
  .card-blue::before{background:linear-gradient(90deg,transparent,var(--blue),transparent);}
  .card-purple::before{background:linear-gradient(90deg,transparent,var(--purple),transparent);}

  .card-title{font-family:'Orbitron',monospace;font-size:13px;letter-spacing:3px;text-transform:uppercase;margin-bottom:8px;}
  .ct-gold{color:var(--gold);} .ct-blue{color:var(--blue);} .ct-purple{color:var(--purple);}

  .card-intro{font-size:13px;color:var(--dim);margin-bottom:22px;line-height:1.6;}
  .card-intro em{color:var(--gold);font-style:normal;}

  /* INPUTS */
  .power-row{display:flex;gap:12px;align-items:flex-end;flex-wrap:wrap;}
  .input-group{flex:1;min-width:200px;}
  .input-label{display:block;font-size:11px;letter-spacing:2px;color:var(--dim);text-transform:uppercase;margin-bottom:8px;font-family:'Share Tech Mono',monospace;}
  input,select,textarea{width:100%;background:var(--surface2);border:1px solid var(--border);color:var(--text);font-family:'Rajdhani',sans-serif;font-size:16px;padding:11px 14px;outline:none;transition:border-color .2s;}
  input[type="number"]{font-family:'Share Tech Mono',monospace;font-size:18px;}
  input[type="number"]::-webkit-inner-spin-button{display:none;}
  input:focus,select:focus,textarea:focus{border-color:var(--blue);box-shadow:0 0 10px rgba(0,180,216,.12);}
  select{cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8'%3E%3Cpath fill='%235a7a94' d='M6 8L0 0h12z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;padding-right:36px;}
  select option{background:var(--surface2);}
  textarea{resize:vertical;min-height:80px;line-height:1.5;}

  .btn-calc{background:linear-gradient(135deg,var(--gold-dim),var(--gold));color:#000;border:none;font-family:'Orbitron',monospace;font-size:12px;font-weight:700;letter-spacing:2px;padding:14px 28px;cursor:pointer;text-transform:uppercase;transition:all .2s;clip-path:polygon(0 0,calc(100% - 10px) 0,100% 10px,100% 100%,10px 100%,0 calc(100% - 10px));white-space:nowrap;}
  .btn-calc:hover{background:linear-gradient(135deg,var(--gold),#ffd060);transform:translateY(-1px);}

  /* SEAT SCALE */
  .seat-scale{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:20px;}
  .scale-item{padding:10px;border:1px solid var(--border);text-align:center;opacity:.4;transition:opacity .3s,border-color .3s;}
  .scale-item.active{opacity:1;}
  .scale-item.active.sw{border-color:var(--white);}
  .scale-item.active.sb{border-color:var(--blue);}
  .scale-item.active.sp{border-color:var(--purple);}
  .scale-item.active.sg{border-color:var(--gold);}
  .sc-emoji{font-size:20px;display:block;margin-bottom:4px;}
  .sc-label{font-family:'Orbitron',monospace;font-size:9px;letter-spacing:1px;}
  .sc-range{color:var(--dim);font-family:'Share Tech Mono',monospace;font-size:10px;margin-top:3px;}

  /* SEAT RESULT */
  .seat-result{margin-top:22px;display:none;animation:fadeIn .4s ease;}
  .seat-result.visible{display:block;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}

  .seat-display{display:flex;align-items:center;gap:20px;padding:20px;border:1px solid;background:#f8fbff;flex-wrap:wrap;}
  .seat-display.sw{border-color:rgba(200,214,224,.4);}
  .seat-display.sb{border-color:rgba(0,180,216,.5);box-shadow:0 0 20px rgba(0,180,216,.1);}
  .seat-display.sp{border-color:rgba(155,93,229,.5);box-shadow:0 0 20px rgba(155,93,229,.15);}
  .seat-display.sg{border-color:rgba(240,180,41,.6);box-shadow:0 0 30px rgba(240,180,41,.2);animation:pulse-gold 3s ease-in-out infinite;}
  @keyframes pulse-gold{0%,100%{box-shadow:0 0 10px rgba(240,180,41,.1);}50%{box-shadow:0 0 35px rgba(240,180,41,.35);}}

  .seat-ico{font-size:52px;line-height:1;}
  .seat-ico.sw{color:var(--white);} .seat-ico.sb{color:var(--blue);} .seat-ico.sp{color:var(--purple);} .seat-ico.sg{color:var(--gold);}
  .seat-info{flex:1;}
  .seat-nm{font-family:'Orbitron',monospace;font-size:22px;font-weight:700;letter-spacing:2px;}
  .seat-nm.sw{color:var(--white);} .seat-nm.sb{color:var(--blue);} .seat-nm.sp{color:var(--purple);} .seat-nm.sg{color:var(--gold);}
  .seat-ds{margin-top:6px;font-size:14px;color:var(--dim);line-height:1.5;}
  .seat-warn{display:flex;align-items:flex-start;gap:10px;margin-top:14px;padding:10px 14px;background:rgba(240,180,41,.06);border-left:2px solid var(--gold-dim);font-size:12px;color:var(--dim);font-family:'Share Tech Mono',monospace;line-height:1.5;}

  /* ALLIANCES */
  .alliance-grid{display:grid;grid-template-columns:1fr;gap:10px;margin-bottom:20px;}
  .allo input[type="radio"]{display:none;}
  .allo-label{display:block;padding:14px;border:1px solid var(--border);background:var(--surface2);cursor:pointer;transition:all .2s;}
  .allo-label:hover{border-color:var(--purple);background:rgba(155,93,229,.05);}
  .allo input:checked+.allo-label{border-color:var(--purple);background:rgba(155,93,229,.12);box-shadow:0 0 16px rgba(155,93,229,.15);}
  .allo input:checked+.allo-label .allo-check{opacity:1;}
  .allo-head{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px;}
  .allo-tag{font-family:'Orbitron',monospace;font-size:14px;font-weight:700;color:var(--gold);}
  .allo-rank{font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--dim);}
  .allo-check{color:var(--purple);font-weight:bold;opacity:0;transition:opacity .2s;}
  .allo-name{font-size:13px;color:var(--text);margin:3px 0 4px;}
  .allo-req{font-size:11px;color:var(--dim);font-family:'Share Tech Mono',monospace;line-height:1.4;}
  .allo-desc{font-size:12px;color:var(--dim);line-height:1.4;font-style:italic;margin-top:6px;}

  /* FORM */
  .form-grid{display:grid;grid-template-columns:1fr;gap:14px;}
  .fg{display:flex;flex-direction:column;gap:7px;}
  .fg.full{grid-column:1/-1;}
  label{font-size:11px;letter-spacing:2px;color:var(--dim);text-transform:uppercase;font-family:'Share Tech Mono',monospace;}
  .opt{color:var(--border);font-size:10px;}

  .btn-submit{background:linear-gradient(135deg,#0a2a40,#0d3d5c);border:1px solid var(--blue);color:var(--blue);font-family:'Orbitron',monospace;font-size:13px;font-weight:700;letter-spacing:3px;padding:16px 48px;cursor:pointer;text-transform:uppercase;transition:all .25s;clip-path:polygon(0 0,calc(100% - 12px) 0,100% 12px,100% 100%,12px 100%,0 calc(100% - 12px));width:100%;max-width:360px;}
  .btn-submit:hover{box-shadow:0 0 30px rgba(0,180,216,.25);color:#fff;}
  .submit-wrap{margin-top:24px;text-align:center;}

  .success-msg{display:none;text-align:center;padding:40px 24px;background:var(--surface);border:1px solid rgba(30,158,194,.4);animation:fadeIn .5s ease;}
  .success-msg.visible{display:block;}
  .ok-icon{font-size:48px;margin-bottom:16px;}
  .ok-title{font-family:'Orbitron',monospace;font-size:20px;color:var(--blue);letter-spacing:2px;margin-bottom:10px;}
  .ok-sub{color:var(--dim);font-size:15px;line-height:1.6;}

  footer{text-align:center;padding:20px;font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--dim);letter-spacing:2px;}

  @media(min-width:720px){
    .form-grid{grid-template-columns:1fr 1fr;}
    .seat-scale{grid-template-columns:repeat(4,1fr);}
    .alliance-grid{grid-template-columns:repeat(2,minmax(0,1fr));}
    .card{padding:28px 24px;margin-bottom:28px;}
  }
</style>
</head>
<body>
<div class="container">

  <!-- LANGUAGE BAR -->
  <div class="lang-bar">
    <button class="lang-btn active" onclick="setLang('it')" title="Italiano">ğŸ‡®ğŸ‡¹</button>
    <button class="lang-btn" onclick="setLang('fr')" title="FranÃ§ais">ğŸ‡«ğŸ‡·</button>
    <button class="lang-btn" onclick="setLang('en')" title="English">ğŸ‡¬ğŸ‡§</button>
    <button class="lang-btn" onclick="setLang('de')" title="Deutsch">ğŸ‡©ğŸ‡ª</button>
  </div>

  <!-- HEADER -->
  <header>
    <div class="header-badge" id="hBadge"></div>
    <h1><span class="sub" id="hAlliance">NGC Alliance</span><span id="hTitle"></span></h1>
    <p class="header-desc" id="hDesc"></p>
  </header>

  <div class="divider"><span class="divider-icon">âš”</span></div>

  <!-- SIMULATOR -->
  <div class="card card-gold">
    <div class="card-title ct-gold" id="simTitle"></div>
    <div class="card-intro" id="simIntro"></div>
    <div class="power-row">
      <div class="input-group">
        <label class="input-label" id="simLabel"></label>
        <input type="number" id="powerInput" min="0">
      </div>
      <button class="btn-calc" id="simBtn" onclick="calcSeat()"></button>
    </div>
    <div class="seat-scale">
      <div class="scale-item sw" id="sc0"><span class="sc-emoji">ğŸª‘</span><div class="sc-label" style="color:var(--white)">FOLLOWER</div><div class="sc-range">&lt; 30M</div></div>
      <div class="scale-item sb" id="sc1"><span class="sc-emoji">ğŸ”µ</span><div class="sc-label" style="color:var(--blue)">PIONEER</div><div class="sc-range">30Mâ€“80M</div></div>
      <div class="scale-item sp" id="sc2"><span class="sc-emoji">ğŸŸ£</span><div class="sc-label" style="color:var(--purple)">CONTRIBUTOR</div><div class="sc-range">80Mâ€“180M</div></div>
      <div class="scale-item sg" id="sc3"><span class="sc-emoji">ğŸ‘‘</span><div class="sc-label" style="color:var(--gold)">ELITE</div><div class="sc-range">&gt; 180M</div></div>
    </div>
    <div class="seat-result" id="seatResult">
      <div class="seat-display" id="seatDisplay">
        <div class="seat-ico" id="seatIcon"></div>
        <div class="seat-info">
          <div class="seat-nm" id="seatName"></div>
          <div class="seat-ds" id="seatDesc"></div>
        </div>
      </div>
      <div class="seat-warn" id="simWarning"></div>
    </div>
  </div>

  <div class="divider"><span class="divider-icon">ğŸ–</span></div>

  <!-- ALLIANCES -->
  <div class="card card-purple">
    <div class="card-title ct-purple" id="allTitle"></div>
    <div class="card-intro" id="allIntro"></div>
    <div class="alliance-grid" id="allianceGrid"></div>
  </div>

  <div class="divider"><span class="divider-icon">ğŸ“‹</span></div>

  <!-- FORM -->
  <div class="card card-blue" id="formSection">
    <div class="card-title ct-blue" id="formTitle"></div>
    <div class="form-grid">
      <div class="fg"><label id="lNick"></label><input type="text" id="fNick"></div>
      <div class="fg"><label id="lPower"></label><input type="number" id="fPower" min="0"></div>
      <div class="fg"><label id="lServer"></label><input type="text" id="fServer"></div>
      <div class="fg">
        <label id="lIntent"></label>
        <select id="fIntent">
          <option value="" id="iOpt0"></option>
          <option value="yes_sure" id="iOpt1"></option>
          <option value="interested" id="iOpt2"></option>
          <option value="maybe" id="iOpt3"></option>
          <option value="no" id="iOpt4"></option>
        </select>
      </div>
      <div class="fg full">
        <label id="lAlliance"></label>
        <select id="fAlliance"><option value="" id="fAlliancePh"></option></select>
      </div>
      <div class="fg full">
        <label id="lBio"></label>
        <textarea id="fBio"></textarea>
      </div>
    </div>
    <div class="submit-wrap"><button class="btn-submit" id="btnSubmit" onclick="submitForm()"></button></div>
  </div>

  <!-- SUCCESS -->
  <div class="success-msg" id="successMsg">
    <div class="ok-icon">âœ…</div>
    <div class="ok-title" id="okTitle"></div>
    <div class="ok-sub" id="okSub"></div>
  </div>

  <footer>NGC Â© 2026 â€” Server #1105 â€” Confidential Recruitment</footer>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TRANSLATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const T = {
  it:{
    badge:'â—† Server #1105 â€” Transfer Surge â—†',
    h1:'CANDIDATURA<br>TRASFERIMENTO',
    hdesc:'Vuoi unirti al nostro server? Scopri la tua sedia e candidati.',
    simTitle:'âš¡ Simulatore Sedia',
    simIntro:'Inserisci la tua <em>potenza totale eroi</em> per stimare il colore della tua sedia.<br>âš  <em>Valore approssimativo</em>: le soglie reali cambiano ad ogni Transfer Surge.',
    simLabel:'Potenza Totale Eroi',
    simPh:'es. 45000000',
    simBtn:'CALCOLA',
    simWarn:'âš  Stima basata su soglie medie. Il colore reale dipenderÃ  dalla forza complessiva del tuo gruppo di server al momento dell\'evento.',
    seatDesc:{white:'Giocatore in crescita. Posti disponibili in buona quantitÃ  nei server aperti.',blue:'Giocatore consolidato. Risorsa preziosa per qualsiasi alleanza.',purple:'Giocatore avanzato. Posti limitati â€” i server forti ti cercano.',gold:'Top player. Posti rarissimi. Il tuo arrivo cambia le sorti di un server.'},
    allTitle:'ğŸ° Conosci le Nostre Alleanze',
    allIntro:'Il server #1105 ospita 8 alleanze con profili diversi. Seleziona quella che fa per te.',
    formTitle:'ğŸ“¬ La Tua Candidatura',
    lNick:'Nickname in Gioco *',nickPh:'Il tuo nome in gioco',
    lPower:'Potenza Totale Eroi *',
    lServer:'Server di Provenienza *',serverPh:'es. #1082',
    lIntent:'Vuoi venire su #1105? (opzionale)',
    iOpts:['â€” Seleziona â€”','SÃ¬, assolutamente!','Mi interessa, voglio piÃ¹ info','Forse, sto valutando','No, solo per info'],
    lAlliance:'Alleanza preferita *',alliancePh:'â€” Scegli un\'alleanza â€”',
    lBio:'Presentati brevemente (opzionale)',bioPh:'Stile di gioco, esperienza, lingua...',
    btnSubmit:'INVIA CANDIDATURA',
    okTitle:'CANDIDATURA RICEVUTA',
    okSub:'Il tuo profilo Ã¨ stato registrato. Un leader ti contatterÃ  durante la fase di preparazione del Transfer Surge.',
    errFields:'âš  Compila tutti i campi obbligatori (*)',
    errPower:'âš  Inserisci una potenza valida!',
    allyTextMissing:'Testi alleanza in aggiornamento'
  },
  fr:{
    badge:'â—† Serveur #1105 â€” Transfer Surge â—†',
    h1:'CANDIDATURE<br>TRANSFERT',
    hdesc:'Tu veux rejoindre notre serveur ? DÃ©couvre ton siÃ¨ge et postule.',
    simTitle:'âš¡ Simulateur de SiÃ¨ge',
    simIntro:'Saisis ta <em>puissance totale des hÃ©ros</em> pour estimer la couleur de ton siÃ¨ge.<br>âš  <em>Valeur approximative</em> : les seuils rÃ©els varient Ã  chaque Transfer Surge.',
    simLabel:'Puissance Totale des HÃ©ros',
    simPh:'ex. 45000000',
    simBtn:'CALCULER',
    simWarn:'âš  Estimation basÃ©e sur des seuils moyens. La couleur rÃ©elle dÃ©pendra de la force de ton groupe de serveurs au moment de l\'Ã©vÃ©nement.',
    seatDesc:{white:'Joueur en progression. Places disponibles en bonne quantitÃ© dans les serveurs ouverts.',blue:'Joueur confirmÃ©. Une ressource prÃ©cieuse pour n\'importe quelle alliance.',purple:'Joueur avancÃ©. Places limitÃ©es â€” les serveurs forts te recherchent.',gold:'Top joueur. Places rarissimes. Ton arrivÃ©e change le destin d\'un serveur.'},
    allTitle:'ğŸ° DÃ©couvres nos Alliances',
    allIntro:'Le serveur #1105 accueille 8 alliances aux profils variÃ©s. SÃ©lectionne celle qui te correspond.',
    formTitle:'ğŸ“¬ Ta Candidature',
    lNick:'Pseudo en Jeu *',nickPh:'Ton pseudo dans le jeu',
    lPower:'Puissance Totale des HÃ©ros *',
    lServer:'Serveur d\'Origine *',serverPh:'ex. #1082',
    lIntent:'Tu veux venir sur #1105 ? (optionnel)',
    iOpts:['â€” SÃ©lectionner â€”','Oui, absolument !','Ã‡a m\'intÃ©resse, je veux plus d\'infos','Peut-Ãªtre, j\'Ã©value encore','Non, juste pour info'],
    lAlliance:'Alliance prÃ©fÃ©rÃ©e *',alliancePh:'â€” Choisir une alliance â€”',
    lBio:'PrÃ©sente-toi briÃ¨vement (optionnel)',bioPh:'Style de jeu, expÃ©rience, langue...',
    btnSubmit:'ENVOYER MA CANDIDATURE',
    okTitle:'CANDIDATURE REÃ‡UE',
    okSub:'Ton profil a Ã©tÃ© enregistrÃ©. Un leader te contactera pendant la phase de prÃ©paration du Transfer Surge.',
    errFields:'âš  Remplis tous les champs obligatoires (*)',
    errPower:'âš  Saisis une puissance valide !',
    allyTextMissing:'Textes d\'alliance en cours de mise Ã  jour'
  },
  en:{
    badge:'â—† Server #1105 â€” Transfer Surge â—†',
    h1:'TRANSFER<br>APPLICATION',
    hdesc:'Want to join our server? Find out your seat and apply.',
    simTitle:'âš¡ Seat Simulator',
    simIntro:'Enter your <em>total hero power</em> to estimate your seat color.<br>âš  <em>Approximate value</em>: real thresholds vary with each Transfer Surge event.',
    simLabel:'Total Hero Power',
    simPh:'e.g. 45000000',
    simBtn:'CALCULATE',
    simWarn:'âš  Estimate based on average thresholds. Your real color depends on your server group\'s overall strength at the time of the event.',
    seatDesc:{white:'Growing player. Plenty of seats available in open servers.',blue:'Established player. A valuable asset for any alliance.',purple:'Advanced player. Limited seats â€” strong servers are looking for you.',gold:'Top player. Extremely rare seats. Your arrival changes a server\'s fate.'},
    allTitle:'ğŸ° Meet Our Alliances',
    allIntro:'Server #1105 is home to 8 alliances with different profiles. Select the one that suits you.',
    formTitle:'ğŸ“¬ Your Application',
    lNick:'In-Game Nickname *',nickPh:'Your in-game name',
    lPower:'Total Hero Power *',
    lServer:'Home Server *',serverPh:'e.g. #1082',
    lIntent:'Do you want to come to #1105? (optional)',
    iOpts:['â€” Select â€”','Yes, absolutely!','Interested, I want more info','Maybe, still considering','No, just for info'],
    lAlliance:'Preferred Alliance *',alliancePh:'â€” Choose an alliance â€”',
    lBio:'Tell us about yourself (optional)',bioPh:'Play style, experience, language...',
    btnSubmit:'SUBMIT APPLICATION',
    okTitle:'APPLICATION RECEIVED',
    okSub:'Your profile has been recorded. A leader will contact you during the Transfer Surge preparation phase.',
    errFields:'âš  Please fill in all required fields (*)',
    errPower:'âš  Enter a valid power value!',
    allyTextMissing:'Alliance text is being updated'
  },
  de:{
    badge:'â—† Server #1105 â€” Transfer Surge â—†',
    h1:'TRANSFER-<br>BEWERBUNG',
    hdesc:'MÃ¶chtest du unserem Server beitreten? Finde deinen Sitz und bewirb dich.',
    simTitle:'âš¡ Sitz-Simulator',
    simIntro:'Gib deine <em>gesamte HeldenstÃ¤rke</em> ein, um deine Sitzfarbe abzuschÃ¤tzen.<br>âš  <em>UngefÃ¤hrer Wert</em>: Die echten Schwellenwerte variieren bei jedem Transfer Surge.',
    simLabel:'Gesamte HeldenstÃ¤rke',
    simPh:'z.B. 45000000',
    simBtn:'BERECHNEN',
    simWarn:'âš  SchÃ¤tzung auf Basis durchschnittlicher Schwellenwerte. Die echte Farbe hÃ¤ngt von der StÃ¤rke deiner Servergruppe zum Zeitpunkt des Events ab.',
    seatDesc:{white:'Wachsender Spieler. Viele PlÃ¤tze in offenen Servern verfÃ¼gbar.',blue:'Erfahrener Spieler. Eine wertvolle Ressource fÃ¼r jede Allianz.',purple:'Fortgeschrittener Spieler. Begrenzte PlÃ¤tze â€” starke Server suchen dich.',gold:'Top-Spieler. Ã„uÃŸerst seltene PlÃ¤tze. Deine Ankunft verÃ¤ndert ein Server-Schicksal.'},
    allTitle:'ğŸ° Unsere Allianzen',
    allIntro:'Server #1105 beherbergt 8 Allianzen mit unterschiedlichen Profilen. WÃ¤hle die passende fÃ¼r dich.',
    formTitle:'ğŸ“¬ Deine Bewerbung',
    lNick:'In-Game-Name *',nickPh:'Dein Spielername',
    lPower:'Gesamte HeldenstÃ¤rke *',
    lServer:'Herkunfts-Server *',serverPh:'z.B. #1082',
    lIntent:'MÃ¶chtest du zu #1105? (optional)',
    iOpts:['â€” AuswÃ¤hlen â€”','Ja, auf jeden Fall!','Interessiert, ich mÃ¶chte mehr Infos','Vielleicht, ich Ã¼berlege noch','Nein, nur zur Info'],
    lAlliance:'Bevorzugte Allianz *',alliancePh:'â€” Allianz wÃ¤hlen â€”',
    lBio:'Stell dich kurz vor (optional)',bioPh:'Spielstil, Erfahrung, Sprache...',
    btnSubmit:'BEWERBUNG ABSENDEN',
    okTitle:'BEWERBUNG ERHALTEN',
    okSub:'Dein Profil wurde gespeichert. Ein Leader wird dich wÃ¤hrend der Vorbereitungsphase des Transfer Surge kontaktieren.',
    errFields:'âš  Bitte fÃ¼lle alle Pflichtfelder (*) aus',
    errPower:'âš  Bitte gib eine gÃ¼ltige StÃ¤rke ein!',
    allyTextMissing:'Allianztexte werden aktualisiert'
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ALLIANCE STATIC DATA (tags, names, ranks â€” language-independent)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ALLIANCES = [
  {tag:'NgC', name:'Night Commando',      rank:'#1 Â· 20,437,739,136'},
  {tag:'DJN', name:'THE RISE',            rank:'#2 Â· 17,955,478,136'},
  {tag:'VNEM',name:'True Unity',          rank:'#3 Â· 17,354,413,687'},
  {tag:'LdKy',name:'GottisUnitedKnights', rank:'#4 Â· 15,637,482,443'},
  {tag:'FmLy',name:'Family01',            rank:'#5 Â· 14,125,841,165'},
  {tag:'BwF', name:'Better with Family',  rank:'#6 Â· 13,976,981,318'},
  {tag:'CZNS',name:'CheZ NouS',           rank:'#8 Â· 12,348,887,479'},
  {tag:'GLDY',name:'GLADÄ°ATORS',          rank:'#9 Â· 8,311,781,670'},
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SEATS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SEATS = [
  {cls:'sw', name:'FOLLOWER',    icon:'ğŸª‘', scaleIdx:0, dk:'white'},
  {cls:'sb', name:'PIONEER',     icon:'ğŸ”µ', scaleIdx:1, dk:'blue'},
  {cls:'sp', name:'CONTRIBUTOR', icon:'ğŸŸ£', scaleIdx:2, dk:'purple'},
  {cls:'sg', name:'ELITE âš¡',    icon:'ğŸ‘‘', scaleIdx:3, dk:'gold'},
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let lang = 'it';
let lastSeatIdx = -1;
let remoteAllianceTexts = {};

function isScriptUrl(url = '') {
  return /^https:\/\/script\.google\.com\/macros\/s\/.+\/exec$/.test(url.trim());
}

function getScriptUrl() {
  const stored = (localStorage.getItem('NGC_SCRIPT_URL') || '').trim();
  const config = ((typeof NGC_CONFIG !== 'undefined' ? NGC_CONFIG.SCRIPT_URL : '') || '').trim();
  if (isScriptUrl(stored)) return stored;
  if (isScriptUrl(config)) return config;
  return '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  setLang â€” full UI refresh
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setLang(l) {
  lang = l;
  document.documentElement.lang = l;

  document.querySelectorAll('.lang-btn').forEach((b,i) => {
    b.classList.toggle('active', ['it','fr','en','de'][i] === l);
  });

  const t = T[l];

  // Header
  document.getElementById('hBadge').innerHTML  = t.badge;
  document.getElementById('hTitle').innerHTML  = t.h1;
  document.getElementById('hDesc').textContent = t.hdesc;

  // Simulator
  document.getElementById('simTitle').innerHTML   = t.simTitle;
  document.getElementById('simIntro').innerHTML   = t.simIntro;
  document.getElementById('simLabel').textContent = t.simLabel;
  document.getElementById('powerInput').placeholder = t.simPh;
  document.getElementById('simBtn').textContent   = t.simBtn;
  document.getElementById('simWarning').textContent = t.simWarn;

  // Alliances section
  document.getElementById('allTitle').innerHTML  = t.allTitle;
  document.getElementById('allIntro').innerHTML  = t.allIntro;
  buildAlliances();

  // Form labels & placeholders
  document.getElementById('formTitle').innerHTML   = t.formTitle;
  document.getElementById('lNick').textContent     = t.lNick;
  document.getElementById('fNick').placeholder     = t.nickPh;
  document.getElementById('lPower').textContent    = t.lPower;
  document.getElementById('lServer').textContent   = t.lServer;
  document.getElementById('fServer').placeholder   = t.serverPh;
  document.getElementById('lIntent').textContent   = t.lIntent;
  document.getElementById('lAlliance').textContent = t.lAlliance;
  document.getElementById('fAlliancePh').textContent = t.alliancePh;
  document.getElementById('lBio').textContent      = t.lBio;
  document.getElementById('fBio').placeholder      = t.bioPh;
  document.getElementById('btnSubmit').textContent = t.btnSubmit;

  // Intent options
  t.iOpts.forEach((txt, i) => {
    const el = document.getElementById('iOpt'+i);
    if (el) el.textContent = txt;
  });

  // Success
  document.getElementById('okTitle').textContent = t.okTitle;
  document.getElementById('okSub').textContent   = t.okSub;

  // Re-render seat if already calculated
  if (lastSeatIdx >= 0) renderSeat(lastSeatIdx, false);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  buildAlliances
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildAlliances() {
  const t   = T[lang];
  const grid = document.getElementById('allianceGrid');
  const sel  = document.getElementById('fAlliance');
  const prev = sel.value;

  grid.innerHTML = '';
  while (sel.options.length > 1) sel.remove(1);

  ALLIANCES.forEach((a, i) => {
    const remote = remoteAllianceTexts[a.tag]?.[lang] || {};
    const td = {
      req: remote.req || t.allyTextMissing,
      desc: remote.desc || '',
    };

    const wrap = document.createElement('div');
    wrap.className = 'allo';
    wrap.innerHTML = `
      <input type="radio" name="alliance" id="al${i}" value="${a.tag}" ${prev===a.tag?'checked':''}>
      <label class="allo-label" for="al${i}">
        <div class="allo-head">
          <span class="allo-tag">[${a.tag}]</span>
          <span class="allo-rank">${a.rank}</span>
          <span class="allo-check">âœ“</span>
        </div>
        <div class="allo-name">${a.name}</div>
        <div class="allo-req">${td.req}</div>
        <div class="allo-desc">${td.desc}</div>
      </label>`;
    wrap.querySelector('input').addEventListener('change', () => { sel.value = a.tag; });
    grid.appendChild(wrap);

    const opt = document.createElement('option');
    opt.value = a.tag;
    opt.textContent = `[${a.tag}] ${a.name}`;
    sel.appendChild(opt);
  });

  sel.value = prev;
}

async function loadAllianceTexts() {
  const scriptUrl = getScriptUrl();
  if (!scriptUrl) return;

  try {
    const res = await fetch(scriptUrl + '?action=getAll&t=' + Date.now());
    const json = await res.json();
    if (json && json.success && json.allianceTexts) {
      remoteAllianceTexts = json.allianceTexts;
      buildAlliances();
    }
  } catch (err) {
    console.warn('Impossibile caricare i testi alleanze dal foglio:', err);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SEAT CALCULATOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getSeatIdx(p) {
  if (p < 30e6)  return 0;
  if (p < 80e6)  return 1;
  if (p < 180e6) return 2;
  return 3;
}

function renderSeat(idx, scroll) {
  const s = SEATS[idx];
  const t = T[lang];

  const display = document.getElementById('seatDisplay');
  display.className = `seat-display ${s.cls}`;

  const icon = document.getElementById('seatIcon');
  icon.className = `seat-ico ${s.cls}`;
  icon.textContent = s.icon;

  const nm = document.getElementById('seatName');
  nm.className = `seat-nm ${s.cls}`;
  nm.textContent = s.name;

  document.getElementById('seatDesc').textContent = t.seatDesc[s.dk];

  document.querySelectorAll('.scale-item').forEach((el,i) => {
    el.classList.toggle('active', i === s.scaleIdx);
  });

  const res = document.getElementById('seatResult');
  res.classList.add('visible');
  if (scroll) res.scrollIntoView({behavior:'smooth', block:'nearest'});
}

function calcSeat() {
  const val = parseFloat(document.getElementById('powerInput').value);
  if (!val || val <= 0) { alert(T[lang].errPower); return; }
  document.getElementById('fPower').value = val;
  lastSeatIdx = getSeatIdx(val);
  renderSeat(lastSeatIdx, true);
}

document.getElementById('powerInput').addEventListener('keydown', e => {
  if (e.key === 'Enter') calcSeat();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FORM SUBMIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function submitForm() {
  const t       = T[lang];
  const nick    = document.getElementById('fNick').value.trim();
  const power   = document.getElementById('fPower').value;
  const server  = document.getElementById('fServer').value.trim();
  const alliance= document.getElementById('fAlliance').value;

  if (!nick || !server || !alliance) { alert(t.errFields); return; }

  const payload = {
    lang, nickname: nick,
    power:   power || '',
    server,  alliance,
    intent:  document.getElementById('fIntent').value,
    bio:     document.getElementById('fBio').value.trim(),
    seat:    lastSeatIdx >= 0 ? SEATS[lastSeatIdx].name : '',
    ts:      new Date().toISOString()
  };

  const APPS_SCRIPT_URL = getScriptUrl();

  const showSuccess = () => {
    document.getElementById('formSection').style.display = 'none';
    const msg = document.getElementById('successMsg');
    msg.classList.add('visible');
    msg.scrollIntoView({behavior:'smooth'});
  };

  const btn = document.getElementById('btnSubmit');
  btn.textContent = '...';
  btn.disabled = true;

  if (!APPS_SCRIPT_URL) {
    alert('Endpoint Apps Script non configurato correttamente.');
    btn.textContent = T[lang].btnSubmit;
    btn.disabled = false;
    return;
  }

  fetch(APPS_SCRIPT_URL, {
    method: 'POST',
    // text/plain evita preflight CORS su Web App GAS mantenendo payload JSON
    headers: {'Content-Type': 'text/plain;charset=utf-8'},
    body: JSON.stringify(payload)
  })
  .then(async r => {
    const text = await r.text();
    try { return JSON.parse(text); }
    catch { throw new Error('Risposta non valida dal server'); }
  })
  .then(res => {
    if (res.success) {
      showSuccess();
    } else {
      alert('Errore: ' + (res.error || 'sconosciuto'));
      btn.textContent = T[lang].btnSubmit;
      btn.disabled = false;
    }
  })
  .catch((err) => {
    alert('Invio non riuscito: ' + (err.message || 'errore di rete/CORS'));
    btn.textContent = T[lang].btnSubmit;
    btn.disabled = false;
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
setLang('it');
loadAllianceTexts();
</script>
</body>
</html>
